version: '3.0'

networks:
        br-v2ray:
                external: false

services:
        nginx:
                container_name: v2ray_nginx
                image: linuxserver/swag
                restart: always
                cap_add:
                        - NET_ADMIN
                networks:
                        - br-v2ray
                environment:
                        - PUID={{ uid }}
                        - PGID={{ gid }}
                        - TZ=US/Eastern
                        - URL={{ domain }}
                        - SUBDOMAINS={{ subdomain }}
                        - VALIDATION=http
                        - EMAIL=dummy@dummy.com
                        - DHLEVEL=2048
                        - ONLY_SUBDOMAINS={{ subdomain_only }}
                        - STAGING=false
                ports:
                        - 80:80
                        - 443:443
                volumes:
                        - ./nginx/default:/config/nginx/site-confs/default
                        - ./nginx/logs:/config/log
        v2ray:
                container_name: v2ray_v2ray
                image: teddysun/v2ray
                restart: unless-stopped
                networks:
                        - br-v2ray
                command: ["v2ray","-config=/etc/v2ray/config.json"]
                volumes:
                        - ./v2ray/config.json:/etc/v2ray/config.json

{{ watchtower }}
